<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Publication Tracker</title>
    <style>
        body { font-family: sans-serif; padding: 0 20px; }
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid transparent;
            border-radius: 4px;
            color: #a94442;
            background-color: #f2dede;
            border-color: #ebccd1;
        }
        .expired-card {
            background-color: #f2dede;
            border-color: #ebccd1;
        }
        .publication-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            padding: 20px 0;
        }
        .publication-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .publication-card h3 {
            margin-top: 0;
        }
    </style>
</head>
<body>
    <h1>Publication Tracker</h1>

    {% if alerts %}
    <div class="alerts">
        <h2>Alerts</h2>
        {% for alert in alerts %}
            <div class="alert">
                <strong>Expired:</strong> The publication "{{ alert.name }}" expired on {{ alert.endDate }}.
            </div>
        {% endfor %}
    </div>
    {% endif %}

    <a href="{{ url_for('add_publication') }}">Add New Publication</a> | 
    <a href="{{ url_for('manage_calendars') }}">Manage Calendars</a> |
    <a href="{{ url_for('upload_holidays') }}">Upload Calendar File</a> |
    <a href="{{ url_for('settings') }}">Settings</a>
    
    <div class="publication-container">
        {% for publication in publications %}
        <div class="publication-card {{ 'expired-card' if publication.status == 'Expired' else '' }}">
            <h3>{{ publication.name }}</h3>
            <p><strong>Town:</strong> {{ publication.town | default('N/A') }}</p>
            <p>
                <strong>File:</strong>
                {% if publication.filename %}
                    <a href="{{ url_for('uploaded_file', filename=publication.filename) }}" target="_blank">View PDF</a>
                {% else %}
                    No File
                {% endif %}
            </p>
            <p><strong>Start Date:</strong> {{ publication.startDate }}</p>
            <p><strong>Duration:</strong> {{ publication.duration }} {{ publication.durationType.replace('_', ' ') | title }}</p>
            <p><strong>End Date:</strong> {{ publication.endDate }}</p>
            <p><strong>Status:</strong> {{ publication.status }}</p>
            <a href="{{ url_for('delete_publication', pub_id=publication.id) }}" 
               onclick="return confirm('Are you sure you want to delete this publication?');">Delete</a>
        </div>
        {% endfor %}
    </div>
</body>
</html>
